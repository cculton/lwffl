<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="noindex, nofollow" />
  <title>LWFFL Site Preview</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    :root {
      --preview-bg: #020617;
      --preview-card: #0f172a;
      --preview-border: #1f2937;
      --preview-text: #e5e7eb;
      --preview-muted: #9ca3af;
      --preview-accent: #38bdf8;
    }

    body {
      margin: 0;
      padding: 32px 16px;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #020617 0%, #020617 35%, #020617 100%);
      color: var(--preview-text);
    }

    .preview-container {
      max-width: 920px;
      margin: 0 auto;
    }

    .preview-header h1 {
      margin: 0;
      font-size: clamp(1.6rem, 2.8vw, 2.2rem);
      letter-spacing: 0.02em;
    }

    .preview-header p {
      margin: 8px 0 0;
      color: var(--preview-muted);
    }

    .preview-grid {
      margin-top: 24px;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      gap: 12px;
      list-style: none;
      padding: 0;
    }

    .preview-grid a {
      display: block;
      padding: 12px 14px;
      border: 1px solid var(--preview-border);
      border-radius: 10px;
      background: var(--preview-card);
      color: var(--preview-text);
      text-decoration: none;
      transition: border-color 0.2s ease, transform 0.2s ease, color 0.2s ease;
    }

    .preview-grid a:hover,
    .preview-grid a:focus-visible {
      border-color: rgba(56, 189, 248, 0.55);
      color: var(--preview-accent);
      transform: translateY(-1px);
      outline: none;
    }

    .preview-footer {
      margin-top: 22px;
      font-size: 0.9rem;
      color: var(--preview-muted);
    }

    .preview-empty {
      margin-top: 24px;
      color: var(--preview-muted);
    }
  </style>
</head>
<body>
  <main class="preview-container">
    <header class="preview-header">
      <h1>LWFFL Site Preview</h1>
      <p>Quick access to all pages for testing and review</p>
    </header>

    <ul id="previewList" class="preview-grid" aria-live="polite"></ul>
    <p id="previewEmpty" class="preview-empty" hidden>No preview pages found.</p>

    <footer class="preview-footer">Developer preview page â€“ not part of production site</footer>
  </main>

  <script>
    const EXCLUDED_FILES = new Set(["preview.html", "nav.html"]);

    function formatTitle(filename) {
      return filename
        .replace(/\.html$/i, "")
        .replace(/[-_]+/g, " ")
        .replace(/\b\w/g, (char) => char.toUpperCase());
    }

    async function loadPreviewLinks() {
      const listEl = document.getElementById("previewList");
      const emptyEl = document.getElementById("previewEmpty");

      try {
        const response = await fetch(".");
        const html = await response.text();
        const doc = new DOMParser().parseFromString(html, "text/html");

        const files = [...doc.querySelectorAll('a[href]')]
          .map((a) => a.getAttribute("href") || "")
          .map((href) => href.split("?")[0].split("#")[0].trim())
          .filter((href) => href && !href.includes("/"))
          .filter((href) => href.toLowerCase().endsWith(".html"))
          .map((href) => href.toLowerCase())
          .filter((href) => !EXCLUDED_FILES.has(href));

        const uniqueSorted = [...new Set(files)].sort((a, b) => a.localeCompare(b));

        if (!uniqueSorted.length) {
          emptyEl.hidden = false;
          return;
        }

        const fragment = document.createDocumentFragment();
        uniqueSorted.forEach((file) => {
          const li = document.createElement("li");
          const link = document.createElement("a");
          link.href = file;
          link.textContent = formatTitle(file);
          li.appendChild(link);
          fragment.appendChild(li);
        });

        listEl.appendChild(fragment);
      } catch (error) {
        emptyEl.hidden = false;
        emptyEl.textContent = "Unable to auto-load preview links in this environment.";
        console.error("Failed to build preview list:", error);
      }
    }

    loadPreviewLinks();
  </script>
</body>
</html>
