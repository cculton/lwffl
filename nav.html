<nav class="league-nav" role="navigation" aria-label="Main navigation">
  <div class="nav-container">
    <a href="index.html" class="nav-brand" aria-label="LWFFL Hub Home">
      <span>LWFFL HUB</span>
    </a>

    <button 
      class="nav-toggle" 
      aria-label="Toggle navigation menu"
      aria-expanded="false"
      aria-controls="main-menu"
      type="button"
    >
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
    </button>

    <ul class="nav-menu" id="main-menu">
      <li class="nav-item">
        <button 
          class="dropdown-trigger" 
          aria-haspopup="true" 
          aria-expanded="false"
          type="button"
        >
          Administrative ▾
        </button>
        <ul class="dropdown-menu">
          <li><a href="constitution.html">League Constitution</a></li>
          <li><a href="amendment-history.html">Amendment History</a></li>
        </ul>
      </li>

      <li class="nav-item">
        <button 
          class="dropdown-trigger" 
          aria-haspopup="true" 
          aria-expanded="false"
          type="button"
        >
          Stats &amp; Records ▾
        </button>
        <ul class="dropdown-menu">
          <li><a href="record-book.html">Record Book</a></li>
          <li><a href="postseason-accomplishments.html">Postseason Accomplishments</a></li>
          <li><a href="season-stats.html">Season Stats</a></li>
          <li><a href="head-to-head.html">H2H History</a></li>
          <li><a href="weekly-performance.html">Weekly Performance</a></li>
        </ul>
      </li>

      <li class="nav-item">
        <button 
          class="dropdown-trigger" 
          aria-haspopup="true" 
          aria-expanded="false"
          type="button"
        >
          Amusement ▾
        </button>
        <ul class="dropdown-menu">
          <li><a href="manager-cards.html">Manager Cards</a></li>
          <li><a href="probability-machine.html">Probability Machine</a></li>
          <li><a href="scorigami.html">Scorigami Search</a></li>
        </ul>
      </li>
    </ul>
  </div>
</nav>

<script>
document.addEventListener('DOMContentLoaded', function() {
  var navToggle = document.querySelector('.nav-toggle');
  var navMenu = document.querySelector('.nav-menu');
  var navItems = document.querySelectorAll('.nav-item');
  var dropdownTriggers = document.querySelectorAll('.dropdown-trigger');
  
  console.log('Nav initialized', { navItems: navItems.length, triggers: dropdownTriggers.length });
  
  // Mobile menu toggle
  if (navToggle && navMenu) {
    navToggle.addEventListener('click', function(e) {
      e.stopPropagation();
      var isActive = navMenu.classList.contains('active');
      
      if (isActive) {
        navMenu.classList.remove('active');
        navToggle.classList.remove('active');
        navToggle.setAttribute('aria-expanded', 'false');
      } else {
        navMenu.classList.add('active');
        navToggle.classList.add('active');
        navToggle.setAttribute('aria-expanded', 'true');
      }
    });
  }

  // Desktop hover
  navItems.forEach(function(item) {
    item.addEventListener('mouseenter', function() {
      if (window.innerWidth > 768) {
        item.classList.add('active');
        var trigger = item.querySelector('.dropdown-trigger');
        if (trigger) trigger.setAttribute('aria-expanded', 'true');
      }
    });
    
    item.addEventListener('mouseleave', function() {
      if (window.innerWidth > 768) {
        item.classList.remove('active');
        var trigger = item.querySelector('.dropdown-trigger');
        if (trigger) trigger.setAttribute('aria-expanded', 'false');
      }
    });
  });

  // Click/tap for all devices
  dropdownTriggers.forEach(function(trigger) {
    trigger.addEventListener('click', function(e) {
      e.preventDefault();
      e.stopPropagation();
      
      var parentItem = trigger.closest('.nav-item');
      var isActive = parentItem.classList.contains('active');
      
      console.log('Trigger clicked', { isActive: isActive });
      
      // Close others on mobile
      if (window.innerWidth <= 768) {
        navItems.forEach(function(item) {
          if (item !== parentItem) {
            item.classList.remove('active');
            var otherTrigger = item.querySelector('.dropdown-trigger');
            if (otherTrigger) otherTrigger.setAttribute('aria-expanded', 'false');
          }
        });
      }
      
      // Toggle this one
      if (isActive) {
        parentItem.classList.remove('active');
        trigger.setAttribute('aria-expanded', 'false');
      } else {
        parentItem.classList.add('active');
        trigger.setAttribute('aria-expanded', 'true');
      }
    });
  });

  // Close on outside click
  document.addEventListener('click', function(e) {
    if (!e.target.closest('.league-nav')) {
      navItems.forEach(function(item) {
        item.classList.remove('active');
        var trigger = item.querySelector('.dropdown-trigger');
        if (trigger) trigger.setAttribute('aria-expanded', 'false');
      });
      
      if (navMenu) navMenu.classList.remove('active');
      if (navToggle) {
        navToggle.classList.remove('active');
        navToggle.setAttribute('aria-expanded', 'false');
      }
    }
  });

  // Close on escape
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
      navItems.forEach(function(item) {
        item.classList.remove('active');
        var trigger = item.querySelector('.dropdown-trigger');
        if (trigger) trigger.setAttribute('aria-expanded', 'false');
      });
      
      if (navMenu) navMenu.classList.remove('active');
      if (navToggle) {
        navToggle.classList.remove('active');
        navToggle.setAttribute('aria-expanded', 'false');
      }
    }
  });

  // Handle resize
  var resizeTimer;
  window.addEventListener('resize', function() {
    clearTimeout(resizeTimer);
    resizeTimer = setTimeout(function() {
      if (window.innerWidth > 768) {
        if (navMenu) navMenu.classList.remove('active');
        if (navToggle) {
          navToggle.classList.remove('active');
          navToggle.setAttribute('aria-expanded', 'false');
        }
        navItems.forEach(function(item) {
          item.classList.remove('active');
        });
      }
    }, 250);
  });
});
</script>
